<!DOCTYPE html>
<!-- saved from url=(0051)https://harnishdesign.net/demo/html/oxyy/otp-6.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, shrink-to-fit=no">
<link href="./favicon.png" rel="icon">
<title>optibasetrades</title>
<meta name="description" content="Login and Register Form Html Template">
<meta name="author" content="harnishdesign.net">
<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.3.slim.min.js"
        integrity="sha256-ZwqZIVdD3iXNyGHbSYdsmWP//UBokj2FHAxKuSBKDSo=" crossorigin="anonymous"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- Web Fonts
========================= -->
<link rel="stylesheet" href="./otp_files/css" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- Stylesheet
========================= -->
<link rel="stylesheet" type="text/css" href="./otp_files/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="./otp_files/all.min.css">
<link rel="stylesheet" type="text/css" href="./otp_files/stylesheet.css">
<!-- Colors Css -->
<link id="color-switcher" type="text/css" rel="stylesheet" href="./otp_files/otp-6.html">
</head>
<body>

<!-- Preloader -->
<div class="preloader" style="display: none;">
  <div class="lds-ellipsis" style="display: none;">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>
</div>
<!-- Preloader End -->

<div id="main-wrapper" class="oxyy-login-register min-vh-100 d-flex flex-column bg-transparent">
  <div class="container my-auto">
    <div class="row g-0">
      <div class="col-11 col-sm-9 col-md-7 col-lg-5 col-xl-4 m-auto text-center py-5">
        <!-- <img src="logo.png" alt="" width="250" height="100" > -->
        <!-- <div class="logo text-center mb-2"> <a href="https://harnishdesign.net/demo/html/oxyy/index.html" title="Oxyy"><img src="./logo.png" alt="Oxyy"></a> </div> -->
        <h4 class="mb-4 mt-3"> Verification</h4>
        <div class="live-section"></div>
        <!-- <p class="text-center"><img class="img-fluid" src="./otp_files/otp-icon.png" alt="verification"></p> -->
        <p class="text-muted mb-4">Enter the verification code we sent to <br>
          <span class="text-dark text-4" id="emfield"></span></p>
        <form id="otp-screen" method="post">
          <div class="input-group">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
            <input type="text" class="form-control text-center text-6 py-2 otp-field" maxlength="1" required="" autocomplete="off">
          </div>
          <div class="d-grid my-4" style="background-color: #0dba77;">
			<button class="btn btn-primary shadow-none" id="verifyBtn" type="submit" onclick="verify()" style="background-color: #2525f0; border: none;">Verify</button>
		  </div>
        </form>
        <p class="text-center text-muted mb-0">Didn't get the code? <a id="again" href="#">Resend it</a></p>
      </div>
    </div>
  </div>
  <div class="container-fluid bg-white py-2">
    <p class="text-center text-2 text-muted mb-0">Copyright Â© 2021 <a href="./otp_files/otp-6.html">optibasetrades</a>. All Rights Reserved.</p>
  </div>
</div>

<!-- Styles Switcher -->
<!-- Styles Switcher End --> 

<!-- Script --> 

<script>
function wait(){

  location.href="./user/Verify.html"


}

function verify(e){
  event.preventDefault()
  $('#verifyBtn').html("Loading...")

  const otpFields = document.querySelectorAll('.otp-field');
    
    // Get the values of all input fields
    let otpValues = [];
    otpFields.forEach(input => {
      otpValues.push(input.value); // Push the value of each input into the array
    });

    // Join the array into a single string (or process it as needed)
    const otp = otpValues.join('');
    console.log(otp); // Example: prints the OTP as a string

    const lsOtp=localStorage.getItem("otp")
    const lsOtpTime=localStorage.getItem("otpExpiration")
    const currentTime=Date.now();
    if (currentTime > lsOtpTime) {
                    console.log("The OTP has expired.");
                    // Swal.fire({
                    //     icon: 'error',
                    //     text: 'The OTP has expired!',
                    //     confirmButtonText: 'OK',
                    //     confirmButtonColor: '#3a64d1',
                    //     allowOutsideClick: true,
                    //     allowEscapeKey: true,
                    // });
                    alert("The OTP has expired")
                    $('#verifyBtn').html("verify")
                }
                
                if(otp!=lsOtp){ 

                  console.log("The OTP is incorrect.");
                    // Swal.fire({
                    //     icon: 'error',
                    //     text: 'The OTP is invalid',
                    //     confirmButtonText: 'OK',
                    //     confirmButtonColor: '#3a64d1',
                    //     allowOutsideClick: true,
                    //     allowEscapeKey: true,
                    // });
                    alert("The OTP is invalid")
                    $('#verifyBtn').html("verify")
                }
                
                else {
                    console.log("The OTP is still valid.");
                    // Proceed with OTP validation or other actions

                    setTimeout(wait,3000)


                }


  // setTimeout(wait,3000)

  
}
$(document).ready(async function () {
       
        
  var em= localStorage.getItem("email")
var emfield=document.getElementById('emfield')
emfield.innerHTML=em;
      
      });
  

 
</script>

<script>

async function resendEmail(values) {
         await $.ajax({
             type: "POST",
             url: " https://optibase-render-xkg4.onrender.com
/auth/register/resend",
             dataType: "json",
             data: { ...values },
             timeout: 30000,
             success: function (data) {
                 console.log(data);
                 $('.live-section').html("A new OTP has been sent to the email address below").addClass('alert-primary')
                 if (data.otp && data.otpExpiration) {
                // Store OTP and expiration time for later use
                const otp = data.otp; // The OTP
                const otpExpiration = data.otpExpiration; // OTP expiration time

                localStorage.setItem("otp",otp)
                localStorage.setItem("otpExpiration",otpExpiration)
                // You can now use otp and otpExpiration in your frontend as needed.
                console.log("OTP:", otp); // For debugging, or store it for OTP verification
                console.log("OTP Expiration:", new Date(otpExpiration)); // Show expiration time in readable format

                // Example of using the OTP to autofill an input or validate
                // document.getElementById('otp-input').value = otp;
            }
                 setTimeout(function () {
                     $(location).prop('href', './otp.html')
                 }, 3000)

             },
             error: function (xhr, status, error) {
                 red();
            
                 console.log(error);
                 $('.live-section').html("User already exists").addClass('alert-danger')
             }
         });

     }


     $('#again').click(function (e) {
         e.preventDefault(); // prevents page reload
         

       
         var email= localStorage.getItem("email")
        
         resendEmail({ email });
        //  blurr();
        //  alert("please re-check your email for a new OTP")
         
     });

</script>
<!-- Style Switcher --> 
<script src="./otp_files/switcher.min.js.download"></script> 
<script src="./otp_files/theme.js.download"></script>

<!-- Start of LiveChat (www.livechat.com) code -->
<!-- Smartsupp Live Chat script -->
<script type="text/javascript">
var _smartsupp = _smartsupp || {};
_smartsupp.key = '8754d5c1a77a300c334790c879a8ed1df0175ed4';
window.smartsupp||(function(d) {
  var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
  s=d.getElementsByTagName('script')[0];c=d.createElement('script');
  c.type='text/javascript';c.charset='utf-8';c.async=true;
  c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
})(document);
</script>

<!-- End of LiveChat code -->
</body></html>